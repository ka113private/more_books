{% extends 'base.html' %}
{% load static %}

{% block title %}マイページ{% endblock %}

{% block head %}
<link href="{% static 'css/shop-item-gh-pages.css' %}" rel="stylesheet">
{% endblock %}

{% block contents %}
<section class="py-5">
    <div class="container px-4 px-lg-5 my-5">
        <div class="row gx-4 gx-lg-5 align-items-center">
            <div class="col-md-4">
                <img class="card-img-top mb-5 mb-md-0 rounded-circle border" src="../../media/{{ object.profile_image }}" alt="..."/>
                <div class="fs-1">
                    <span>{{ object.username }}</span>
                </div>
                <a class="btn btn-secondary" href="#">プロフィールを編集</a>
            </div>
            <div class="col-md-8">
                <p class="h2">読みたい</p>
                 <div class="container-fluid">
                     <div class="row flex-nowrap">
                         {% for want_key, want_is_favo in want_dic.items %}
                         <div class="col-2">
                             <div class="card">
                                 <a href="{%url 'books:book_detail' want_key.book_id.pk %}">
                                     <img class="card-img-top" src="../../media/{{ want_key.book_id.thumbnail_image }}" alt="">
                                 </a>
                             </div>
                             {% if want_is_favo %}
                              <i class="fas fa-solid fa-star text-warning"></i>
                             {% endif %}
                         </div>
                         {% endfor %}
                     </div>
                 </div>
                <p class="h2">続きを読む</p>
                 <div class="container-fluid">
                     <div class="row flex-nowrap">
                         {% for reading_key, reading_is_favo in reading_dic.items %}
                         <div class="col-2">
                             <div class="card">
                                 <a href="{%url 'books:book_detail' reading_key.book_id.pk %}">
                                     <img class="card-img-top" src="../../media/{{ reading_key.book_id.thumbnail_image }}" alt="">
                                 </a>
                             </div>
                             {% if reading_is_favo %}
                              <i class="fas fa-solid fa-star text-warning"></i>
                             {% endif %}
                         </div>
                         {% endfor %}
                     </div>
                 </div>
                <p class="h2">もう一度読む</p>
                 <div class="container-fluid">
                     <div class="row flex-nowrap">
                         {% for read_key, read_is_favo in read_dic.items %}
                         <div class="col-2">
                             <div class="card">
                                 <a href="{%url 'books:book_detail' read_key.book_id.pk %}">
                                     <img class="card-img-top" src="../../media/{{ read_key.book_id.thumbnail_image }}" alt="">
                                 </a>
                             </div>
                             {% if read_is_favo %}
                              <i class="fas fa-solid fa-star text-warning"></i>
                             {% endif %}
                         </div>
                         {% endfor %}
                     </div>
                 </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

<!--
{% block extrajs %}
★非同期でいいねにする機能は後で実装
<script type="text/javascript">
    document.getElementByID('ajax-favorite-book').addEventListener('click',e => {
    e.preventDefault();
    const url = '{% url "books:favorite_book" %}';
    fetch(url, {
    method: 'POST',
    body: 'book_pk={{book.pk}}',
    headers:{
        'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8,
        'X-CSRFToken': '{{csrf_token}}',
    },
    }).then(responce => {
    return responce.json();
    }).then(responce => {
    console.log(responce);
    }).catch(error => {
    console.log(error);
    });
    });
</script>
{% endblock %}
-->